(self.webpackChunkencryption_toolkit=self.webpackChunkencryption_toolkit||[]).push([[980],{477:()=>{},3432:(t,e,n)=>{"use strict";n(6111),n(932);function r(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=Math.random()*Math.random();let n=t?Math.floor(4294967295*e):Math.floor(1e4*e)-500;return Math.random()<.5&&(n=-n),n}var s=n(6159),o=n.n(s);n(7361);!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9999;Date.now().toString().slice(0,6),Math.floor(Math.random()*t)}();self.addEventListener("message",async t=>{const{type:e,load:n}=t.data;if("shuffle"===e){const{uint8:t,allChar:e}=n;if(!t)return self.postMessage({type:"error",error:"No input provided."});try{const n=function(t){const e=Math.floor(100*Math.random()),n=Math.floor(100*Math.random()),r=new Uint8Array(e),s=new Uint8Array(n);crypto.getRandomValues(r),crypto.getRandomValues(s);const o=new Uint8Array(e+t.length+n+2);return o.set(r,0),o.set(t,e),o.set(s,e+t.length),o[o.length-2]=e,o[o.length-1]=n,o}(t),s=function(t){const e=new Uint32Array([t.length]),n=4*Math.ceil(t.length/4),r=new Uint8Array(4+n);return r.set(new Uint8Array(e.buffer),0),r.set(t,4),new Uint32Array(r.buffer)}(n),{shuffled:o,key:i}=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Uint32Array(t.length),s=new Int32Array(t.length);for(let o=0;o<t.length;o++){const i=r(e);s[o]=i,n[o]=t[o]+i}return{shuffled:n,key:s}}(s,e);self.postMessage({type:"done-shuffle",result:{shuffled:o,key:i}})}catch(a){var s;self.postMessage({type:"error",error:null!==(s=null===a||void 0===a?void 0:a.message)&&void 0!==s?s:String(a)})}}else if("unshuffle"===e){let{shuffled:e,key:r}=n;try{const n=function(t,e){const n=new Uint32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]-e[r];return n}(e,r),s=function(t){if(t.length<2)throw new Error("Invalid data");const e=t[t.length-2],n=t[t.length-1];return t.slice(e,t.length-n-2)}(function(t){const e=new DataView(t.buffer).getUint32(0,!0);return new Uint8Array(t.buffer,4).slice(0,e)}(n)),i=await async function(e){if(e.length>=2&&236===e[0]&&1===e[1])return"ec";const n=[...e.slice(0,8)].map(t=>t.toString(16).padStart(2,"0")).join("").toUpperCase();if(n.startsWith("504B0304"))try{const t=await o().loadAsync(e),n=Object.keys(t.files);return n.some(t=>t.startsWith("word/"))?"docx":n.some(t=>t.startsWith("xl/"))?"xlsx":n.some(t=>t.startsWith("ppt/"))?"pptx":"zip"}catch(t){return"zip"}if(n.startsWith("89504E47"))return"png";if(n.startsWith("FFD8FF"))return"jpg";if(n.startsWith("25504446"))return"pdf";if(n.startsWith("47494638"))return"gif";if(n.includes("66747970"))return"mp4";if(n.startsWith("52494646"))return"wav";if(n.startsWith("000001BA"))return"mpg";if(e.slice(0,512).some(t=>t<9||t>13&&t<32||t>126))return"bin";const r=(new TextDecoder).decode(e.slice(0,1024)).trim();return r.startsWith("{")||r.startsWith("[")?"json":r.includes(",")&&r.match(/\n|;/)?"csv":"txt"}(s);self.postMessage({type:"done-unshuffle",result:{origin:s,ext:i}})}catch(a){var i;self.postMessage({type:"error",error:null!==(i=null===a||void 0===a?void 0:a.message)&&void 0!==i?i:String(a)})}}})}}]);
//# sourceMappingURL=980.eabb50c2.chunk.js.map