(self.webpackChunkencryption_toolkit=self.webpackChunkencryption_toolkit||[]).push([[718],{477:()=>{},7594:(t,e,r)=>{"use strict";r(6111);var n=r(932);function s(t){return(new TextDecoder).decode(t)}function o(t){return n.Ay.deflate(t)}function i(t){return n.Ay.inflate(t)}function a(t){const e=atob(t),r=e.length,n=new Uint8Array(r);for(let s=0;s<r;s++)n[s]=e.charCodeAt(s);return n}function l(t){const e=()=>{const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]};let r;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){r=t?e():e()%1e6;crypto.getRandomValues(new Uint8Array(1))[0]%2===0&&(r=-r)}else r=t?e()%1114112:e()%1e4+1;return r}async function c(t,e){const r=new TextEncoder,n=crypto.getRandomValues(new Uint8Array(16)),s=crypto.getRandomValues(new Uint8Array(12)),o=await crypto.subtle.importKey("raw",r.encode(e),{name:"PBKDF2"},!1,["deriveKey"]),i=await crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!1,["encrypt"]),a="string"===typeof t?r.encode(t):t,l=await crypto.subtle.encrypt({name:"AES-GCM",iv:s},i,a),c=new Uint8Array(n.length+s.length+l.byteLength);return c.set(n,0),c.set(s,n.length),c.set(new Uint8Array(l),n.length+s.length),c}async function u(t,e){const r=t,n=r.slice(0,16),s=r.slice(16,28),o=r.slice(28),i=new TextEncoder,a=await crypto.subtle.importKey("raw",i.encode(e),{name:"PBKDF2"},!1,["deriveKey"]),l=await crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!1,["decrypt"]),c=await crypto.subtle.decrypt({name:"AES-GCM",iv:s},l,o);return new Uint8Array(c)}var f=r(6159),d=r.n(f);r(7361);!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9999;Date.now().toString().slice(0,6),Math.floor(Math.random()*t)}();self.addEventListener("message",async t=>{const{type:e,load:r,dataPw:n,keyPw:f}=t.data;if("shuffle"===e){const{input:t,allChar:e}=r;let s=t;if(!s)return self.postMessage({type:"error",error:"No input provided."});try{const{shuffled:t,key:r}=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r={shuffled:"",key:[]};for(let n=0;n<t.length;n++){const s=t[n].codePointAt(0);let o,i;do{o=l(e),i=s+o}while(i>1114111||i<0||i>=55296&&i<=57343);r.shuffled+=String.fromCodePoint(i),r.key.push(o)}return r.key=r.key.join(","),{shuffled:r.shuffled,key:r.key}}(s,e);let i="",a="";if(n&&f)try{const e=o(t),s=o(r);i=await c(e,n),a=await c(s,f)}catch(w){var y;self.postMessage({type:"error",error:null!==(y=null===w||void 0===w?void 0:w.message)&&void 0!==y?y:String(w)})}self.postMessage({type:"done-shuffle",result:{shuffled:t,key:r},encryptedData:i,encryptedKey:a})}catch(w){var p;self.postMessage({type:"error",error:null!==(p=null===w||void 0===w?void 0:w.message)&&void 0!==p?p:String(w)})}}else if("unshuffle"===e){let{shuffled:e,key:o}=r;try{if(n&&f)try{const t=await u(e,n),r=await u(o,f),a=i(t),l=i(r);e=s(a),o=s(l)}catch(w){var h;self.postMessage({type:"error",error:null!==(h=null===w||void 0===w?void 0:w.message)&&void 0!==h?h:String(w)})}const r=await async function(t,e){const r=e.split(",").map(Number);let n="",s=0;for(const i of t){var o;let t=(i.codePointAt(0)-(null!==(o=r[s++])&&void 0!==o?o:0)+1114111)%1114111;n+=String.fromCodePoint(t)}return n}(e,o);let l,c;try{const e=a(r);c=await async function(e){if(e.length>=2&&236===e[0]&&1===e[1])return"ec";const r=[...e.slice(0,8)].map(t=>t.toString(16).padStart(2,"0")).join("").toUpperCase();if(r.startsWith("504B0304"))try{const t=await d().loadAsync(e),r=Object.keys(t.files);return r.some(t=>t.startsWith("word/"))?"docx":r.some(t=>t.startsWith("xl/"))?"xlsx":r.some(t=>t.startsWith("ppt/"))?"pptx":"zip"}catch(t){return"zip"}if(r.startsWith("89504E47"))return"png";if(r.startsWith("FFD8FF"))return"jpg";if(r.startsWith("25504446"))return"pdf";if(r.startsWith("47494638"))return"gif";if(r.includes("66747970"))return"mp4";if(r.startsWith("52494646"))return"wav";if(r.startsWith("000001BA"))return"mpg";if(e.slice(0,512).some(t=>t<9||t>13&&t<32||t>126))return"bin";const n=(new TextDecoder).decode(e.slice(0,1024)).trim();return n.startsWith("{")||n.startsWith("[")?"json":n.includes(",")&&n.match(/\n|;/)?"csv":"txt"}(e),l="bin"!==c?a(r):r}catch(w){l=r,c="txt"}self.postMessage({type:"done-unshuffle",result:{output:l,ext:c}})}catch(w){var g;self.postMessage({type:"error",error:null!==(g=null===w||void 0===w?void 0:w.message)&&void 0!==g?g:String(w)})}}})}}]);
//# sourceMappingURL=718.93b9a755.chunk.js.map