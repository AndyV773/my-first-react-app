(self.webpackChunkencryption_toolkit=self.webpackChunkencryption_toolkit||[]).push([[980],{477:()=>{},3432:(t,e,n)=>{"use strict";n(6111),n(932);function r(t){const e=()=>{const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]};let n;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){n=t?e():e()%1e6;crypto.getRandomValues(new Uint8Array(1))[0]%2===0&&(n=-n)}else n=t?e()%1114112:e()%1e4+1;return n}var s=n(6159),i=n.n(s);n(7361);!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9999;Date.now().toString().slice(0,6),Math.floor(Math.random()*t)}();self.addEventListener("message",async t=>{const{type:e,load:n}=t.data;if("shuffle"===e){const{uint8:t,allChar:e}=n;if(!t)return self.postMessage({type:"error",error:"No input provided."});try{const n=function(t){const e=crypto.getRandomValues(new Uint32Array(1))[0]%99,n=crypto.getRandomValues(new Uint32Array(1))[0]%99,r=new Uint8Array(e),s=new Uint8Array(n);crypto.getRandomValues(r),crypto.getRandomValues(s);const i=new Uint8Array(e+t.length+n+2);return i.set(r,0),i.set(t,e),i.set(s,e+t.length),i[i.length-2]=e,i[i.length-1]=n,i}(t),s=function(t){const e=4*Math.ceil(t.length/4),n=new Uint8Array(e);n.set(t);const r=new Uint32Array(e/4+1);r[0]=t.length;for(let s=0;s<e/4;s++)r[s+1]=n[4*s]<<24|n[4*s+1]<<16|n[4*s+2]<<8|n[4*s+3];return r}(n),{shuffled:i,key:o}=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Uint32Array(t.length),s=new Int32Array(t.length);for(let i=0;i<t.length;i++){const o=r(e,!0);s[i]=o,n[i]=t[i]+o}return{shuffled:n,key:s}}(s,e);self.postMessage({type:"done-shuffle",result:{shuffled:i,key:o}})}catch(a){var s;self.postMessage({type:"error",error:null!==(s=null===a||void 0===a?void 0:a.message)&&void 0!==s?s:String(a)})}}else if("unshuffle"===e){let{shuffled:e,key:r}=n;try{const n=function(t,e){const n=new Uint32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]-e[r];return n}(e,r),s=function(t){if(t.length<2)throw new Error("Invalid data");const e=t[t.length-2],n=t[t.length-1];return t.slice(e,t.length-n-2)}(function(t){let e;if(t instanceof Uint32Array)e=t;else if(Array.isArray(t))e=new Uint32Array(t);else{if("string"!==typeof t)return"Error: Invalid Uint32 input.";{const n=t.split(",").map(t=>parseInt(t.trim(),10));if(n.some(isNaN))return"Error: Invalid Uint32 input.";e=new Uint32Array(n)}}if(e.length<1)return new Uint8Array;const n=e[0],r=new Uint8Array(4*(e.length-1));for(let s=0;s<e.length;s++){const t=e[s],n=4*(s-1);r[n]=t>>>24&255,r[n+1]=t>>>16&255,r[n+2]=t>>>8&255,r[n+3]=255&t}return r.subarray(0,n)}(n)),o=await async function(e){if(e.length>=2&&236===e[0]&&1===e[1])return"ec";const n=[...e.slice(0,8)].map(t=>t.toString(16).padStart(2,"0")).join("").toUpperCase();if(n.startsWith("504B0304"))try{const t=await i().loadAsync(e),n=Object.keys(t.files);return n.some(t=>t.startsWith("word/"))?"docx":n.some(t=>t.startsWith("xl/"))?"xlsx":n.some(t=>t.startsWith("ppt/"))?"pptx":"zip"}catch(t){return"zip"}if(n.startsWith("89504E47"))return"png";if(n.startsWith("FFD8FF"))return"jpg";if(n.startsWith("25504446"))return"pdf";if(n.startsWith("47494638"))return"gif";if(n.includes("66747970"))return"mp4";if(n.startsWith("52494646"))return"wav";if(n.startsWith("000001BA"))return"mpg";if(e.slice(0,512).some(t=>t<9||t>13&&t<32||t>126))return"bin";const r=(new TextDecoder).decode(e.slice(0,1024)).trim();return r.startsWith("{")||r.startsWith("[")?"json":r.includes(",")&&r.match(/\n|;/)?"csv":"txt"}(s);self.postMessage({type:"done-unshuffle",result:{origin:s,ext:o}})}catch(a){var o;self.postMessage({type:"error",error:null!==(o=null===a||void 0===a?void 0:a.message)&&void 0!==o?o:String(a)})}}})}}]);
//# sourceMappingURL=980.1db8f686.chunk.js.map